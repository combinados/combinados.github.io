"use strict";angular.module("bolao.carrossel",[]).directive("carrossel",["BD","$timeout",function(a,e){return{restrict:"E",transclude:"true",replace:"true",templateUrl:"components/carrossel/diretivas/diretiva-carrossel.html",scope:{totalPaginas:"=",boleiro:"="},controller:["$scope",function(i){i.direcao="esquerda",i.paginas=[];var r=this,o=1,t=function(a){angular.forEach(i.paginas,function(e){return e.conteudo.id===a?void e.exibir():void 0})};i.atualizarPagina=function(r,n){i.direcao=void 0===n?o>=r?"esquerda":"direita":n;var c=!0,l=!1;angular.forEach(i.paginas,function(a){a.conteudo.id===o&&(a.ocultar(),l=!0),a.conteudo.id===r&&(c=!1),!c&&l}),c&&i.boleiro.rodadas.push(a.pegarRodada(i.boleiro.id,r)),e(function(){t(r)},100),o=r},i.ehPaginaAtual=function(a){return o===a},i.proximaPagina=function(){var a=o,e=a<i.totalPaginas?++a:1;i.atualizarPagina(e,"direita")},i.paginaAnterior=function(){var a=o,e=a>1?--a:i.totalPaginas;i.atualizarPagina(e,"esquerda")},r.adicionarPagina=function(a){1===o&&a.exibir(),i.paginas.push(a)}}]}}]).directive("pagina",function(){return{require:"^carrossel",restrict:"E",transclude:"true",replace:"true",scope:{conteudo:"="},link:function(a,e,i,r){a.exibir=function(){a.visivel=!0,a.detalheVisivel=!0},a.ocultar=function(){a.visivel=!1,a.detalheVisivel=!1},a.alternarDetalhe=function(){a.detalheVisivel=!a.detalheVisivel},a.ocultar(),r.adicionarPagina(a)},templateUrl:"components/carrossel/diretivas/diretiva-paginas.html"}}),angular.module("bolao.acordeon",[]).directive("acordeon",function(){return{restrict:"E",transclude:"true",replace:"true",templateUrl:"components/acordeon/diretivas/diretiva-acordeon.html",scope:"true",controller:["$scope",function(a){var e=this,i=0;a.itens=[],e.adicionarItem=function(e){a.itens.push(e)},e.abrir=function(e){e===i?a.itens[i].visivel?a.itens[e].ocultar():a.itens[e].exibir():(a.itens[i].ocultar(),a.itens[e].exibir()),i=e}}]}}).directive("item",["BD",function(a){return{require:"^acordeon",restrict:"E",transclude:"true",replace:"true",scope:{boleiro:"=",indice:"@"},link:function(e,i,r,o){e.direcao="esquerda",e.exibir=function(){e.visivel=!0,e.situacao="item-aberto"},e.abrir=function(i){var r=e.boleiro.rodadas;"object"==typeof r&&r instanceof Array&&(r.length||e.boleiro.rodadas.push(a.pegarRodada(e.boleiro.id,1))),o.abrir(i)},e.ocultar=function(){e.visivel=!1,e.situacao="item-fechado"},e.ocultar(),o.adicionarItem(e)},templateUrl:"components/acordeon/diretivas/diretiva-item.html"}}]),angular.module("bolao",["bolao.carrossel","bolao.acordeon"]),angular.module("bolao").factory("BD",["$http","$templateCache",function(a,e){var i,r="bd.json",o=function(a){return a.rodadas=[],a},t=function(a,e){for(var i=0;i<e.length;i++)if(e[i].id===a)return e[i]},n=function(a,e){for(var i=0;i<e.length;i++)if(e[i].id===a)return e[i]};return{pegarBoleiros:function(){return a({method:"GET",url:r,cache:e,headers:{"X-Api-Secret":"xxx",Authorization:"xxx","Content-Type":"undefined"}}).then(function(a){i=a.data;var e=[];return angular.copy(i,e),e.map(o)})},pegarRodada:function(a,e){var r=t(a,i);return n(e,r.rodadas)}}}]),angular.module("bolao").controller("ControlePrincipal",["$scope","BD",function(a,e){a.boleiros=[],e.pegarBoleiros().then(function(e){a.boleiros=e})}]),angular.module("bolao").run(["$templateCache",function(a){a.put("components/acordeon/diretivas/diretiva-acordeon.html",'<div class="acordeon" ng-transclude=""></div>'),a.put("components/acordeon/diretivas/diretiva-item.html",'<div class="item {{situacao}}"><div class="item-cabecalho {{situacao}}" ng-click="abrir(indice)"><img ng-src="{{boleiro.foto}}{{1 * indice + 1}}.png"><div class="nome">{{boleiro.nome}}</div><div class="valores">Pontos: {{boleiro.pontos}}</div><div class="valores">Placares: {{boleiro.placares}}</div><div class="valores">Média: {{boleiro.placares}}</div></div><div ng-transclude=""></div></div>'),a.put("components/carrossel/diretivas/diretiva-carrossel.html",'<div class="carrossel"><nav class="navegacao"><ul class="pontos"><li class="ponto" ng-class="{\'ativo\':ehPaginaAtual($index + 1)}" ng-repeat="pagina in (0|number:totalPaginas - 2 ) track by $index" ng-click="atualizarPagina($index + 1);">{{$index + 1}}</li></ul></nav><div ng-transclude="" class="paginas {{direcao}}"></div><a class="seta anterior" ng-click="paginaAnterior()"></a> <a class="seta proxima" ng-click="proximaPagina()"></a></div>'),a.put("components/carrossel/diretivas/diretiva-paginas.html",'<div class="pagina" ng-hide="!visivel"><div class="conteudo" ng-transclude="" ng-click="alternarDetalhe()"></div><div ng-click="alternarDetalhe()" class="detalhe" ng-class="{ocultar : !detalheVisivel}"><div>Detalhes da Rodada</div><label>Número</label><input class="caixa-texto" type="text" ng-click="$event.stopPropagation();" value="{{$parent.$index}}"> <label>Descrição</label><input class="caixa-texto" type="text" ng-click="$event.stopPropagation();" value="{{conteudo.descricao}}"></div></div>')}]);