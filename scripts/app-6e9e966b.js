"use strict";angular.module("bolao.carrossel",[]).directive("carrossel",["BD","$timeout",function(a,o){return{restrict:"E",transclude:"true",replace:"true",templateUrl:"components/carrossel/diretivas/diretiva-carrossel.html",scope:{totalPaginas:"=",boleiro:"="},controller:["$scope",function(e){e.direcao="esquerda",e.paginas=[];var t=this,i=1,r=function(a){angular.forEach(e.paginas,function(o){return o.conteudo.id===a?void o.exibir():void 0})};e.atualizarPagina=function(t,n){e.direcao=void 0===n?i>=t?"esquerda":"direita":n;var s=!0,l=!1;angular.forEach(e.paginas,function(a){a.conteudo.id===i&&(a.ocultar(),l=!0),a.conteudo.id===t&&(s=!1),!s&&l}),s&&e.boleiro.rodadas.push(a.pegarRodada(e.boleiro.id,t)),o(function(){r(t)},100),i=t},e.ehPaginaAtual=function(a){return i===a},e.proximaPagina=function(){var a=i,o=a<e.totalPaginas?++a:1;e.atualizarPagina(o,"direita")},e.paginaAnterior=function(){var a=i,o=a>1?--a:e.totalPaginas;e.atualizarPagina(o,"esquerda")},t.adicionarPagina=function(a){1===i&&a.exibir(),e.paginas.push(a)}}]}}]).directive("pagina",function(){return{require:"^carrossel",restrict:"E",transclude:"true",replace:"true",scope:{conteudo:"="},link:function(a,o,e,t){a.exibir=function(){a.visivel=!0,a.detalheVisivel=!0},a.ocultar=function(){a.visivel=!1,a.detalheVisivel=!1},a.alternarDetalhe=function(){a.detalheVisivel=!a.detalheVisivel},a.ocultar(),t.adicionarPagina(a)},templateUrl:"components/carrossel/diretivas/diretiva-paginas.html"}}),angular.module("bolao.acordeon",[]).directive("acordeon",function(){return{restrict:"E",transclude:"true",replace:"true",templateUrl:"components/acordeon/diretivas/diretiva-acordeon.html",scope:"true",controller:["$scope",function(a){a.itens=[];var o=this,e=2,t=0,i=0,r=0,n=function(o){e>i?(o.tipo="item-premiado",i++,0===t&&(t=o.boleiro.pontos),t>o.boleiro.pontos&&(t=o.boleiro.pontos)):t<o.boleiro.pontos?(angular.forEach(a.itens,function(a){a.boleiro.pontos===t&&(a.tipo="")}),t=o.boleiro.pontos,o.tipo="item-premiado"):t===o.boleiro.pontos&&angular.forEach(a.itens,function(a){a.boleiro.pontos===t&&(o.boleiro.placares>a.boleiro.placares?(a.tipo="",o.tipo="item-premiado"):o.boleiro.placares===a.boleiro.placares&&(o.tipo="item-premiado"))})};o.adicionarItem=function(o){o.tipo="premiado",n(o),a.itens.push(o)},o.abrir=function(o){o===r?a.itens[r].visivel?a.itens[o].ocultar():a.itens[o].exibir():(a.itens[r].ocultar(),a.itens[o].exibir()),r=o}}]}}).directive("item",["BD",function(a){return{require:"^acordeon",restrict:"E",transclude:"true",replace:"true",scope:{boleiro:"=",indice:"@"},link:function(o,e,t,i){o.direcao="esquerda",o.exibir=function(){o.visivel=!0,o.situacao="item-aberto"},o.abrir=function(e){var t=o.boleiro.rodadas;"object"==typeof t&&t instanceof Array&&(t.length||o.boleiro.rodadas.push(a.pegarRodada(o.boleiro.id,1))),i.abrir(e)},o.ocultar=function(){o.visivel=!1,o.situacao="item-fechado"},o.ocultar(),i.adicionarItem(o)},templateUrl:"components/acordeon/diretivas/diretiva-item.html"}}]),angular.module("bolao",["bolao.carrossel","bolao.acordeon","ngTouch"]),angular.module("bolao").factory("BD",["$http","$templateCache",function(a,o){var e,t,i="bd.json",r=function(a){return"Gabarito"!==a.nome?n(a):void(t=a)},n=function(a){for(var o=null,e=0;e<a.rodadas.length;e++){o=a.rodadas[e];for(var i=0;i<o.jogos.length;i++){var r=o.jogos[i],n=t.rodadas[e].jogos[i];r.pontos=s(r,n),o.pontos+=r.pontos}}a.pontos=a.rodadas.reduce(function(a,o){return a+o.pontos},0);for(var l=0;l<a.rodadas.length;l++){var d=a.rodadas[l].jogos.filter(function(a){return 3===a.pontos?a:void 0});a.placares+=a.rodadas[l].placares=d.length}var c=a.rodadas.filter(function(a){return a.pontos>0}).length;return a.mediaPontos=a.pontos/c,a.mediaPlacares=a.placares/c,a.totalRodadas=a.rodadas.length,a},s=function(a,o){return""===o.mandante.gols||""===o.visitante.gols||""===a.mandante.gols||""===a.visitante.gols?0:o.mandante.gols===a.mandante.gols&&o.visitante.gols===a.visitante.gols?3:o.mandante.gols===o.visitante.gols&&a.mandante.gols===a.visitante.gols||o.mandante.gols<o.visitante.gols&&a.mandante.gols<a.visitante.gols||o.mandante.gols>o.visitante.gols&&a.mandante.gols>a.visitante.gols?1:0},l=function(a){return angular.extend(d(a.id),a),a.rodadas=[],a},d=function(a){var o=e.filter(function(o){return o.id===a?o:void 0});return o[0]},c=function(a,o){for(var e=0;e<o.length;e++)if(o[e].id===a)return o[e]};return{pegarBoleiros:function(){return a({method:"GET",url:i,cache:o,headers:{"X-Api-Secret":"xxx",Authorization:"xxx","Content-Type":"undefined"}}).then(function(a){e=a.data;var o=JSON.parse(JSON.stringify(a.data));return o.filter(r).map(l)})},pegarRodada:function(a,o){var e=d(a);return c(o,e.rodadas)}}}]),angular.module("bolao").controller("NavbarCtrl",["$scope",function(a){a.date=new Date}]),angular.module("bolao").controller("ControlePrincipal",["$scope","BD",function(a,o){a.boleiros=[],o.pegarBoleiros().then(function(o){a.boleiros=o})}]),angular.module("bolao").run(["$templateCache",function(a){a.put("components/navbar/navbar.html",'<nav class="navbar" ng-controller="NavbarCtrl"><a href="https://github.com/Swiip/generator-gulp-angular">Gulp Angular</a><ul><li class="active"><a ng-href="#">Home</a></li><li><a ng-href="#">About</a></li><li><a ng-href="#">Contact</a></li></ul><ul><li><a ng-href="#">Current date: {{ date | date:\'yyyy-MM-dd\' }}</a></li></ul></nav>'),a.put("components/acordeon/diretivas/diretiva-acordeon.html",'<div class="acordeon" ng-transclude=""></div>'),a.put("components/acordeon/diretivas/diretiva-item.html",'<div class="item {{situacao}}"><div class="item-cabecalho {{situacao}} {{tipo}}" ng-click="abrir(indice)"><figure><img ng-src="{{boleiro.foto}}"> <img ng-src="{{boleiro.campeao.escudo}}"><figcaption>Meu campeão: {{boleiro.campeao.pontos}} pontos</figcaption></figure><div class="nome">{{boleiro.nome}}</div><div class="valores">Pontos<br>{{boleiro.pontos}}</div><div class="valores">Placares<br>{{boleiro.placares}}</div></div><div ng-transclude=""></div></div>'),a.put("components/carrossel/diretivas/diretiva-carrossel.html",'<div class="carrossel"><nav class="navegacao"><ul class="pontos"><li class="ponto" ng-class="{\'ativo\':ehPaginaAtual($index + 1)}" ng-repeat="pagina in (0|number:totalPaginas - 2 ) track by $index" ng-click="atualizarPagina($index + 1);">{{$index + 1}}</li></ul></nav><div ng-transclude="" class="paginas {{direcao}}" ng-swipe-left="paginaAnterior()" ng-swipe-right="proximaPagina()"></div><a class="seta anterior" ng-click="paginaAnterior()"></a> <a class="seta proxima" ng-click="proximaPagina()"></a></div>'),a.put("components/carrossel/diretivas/diretiva-paginas.html",'<div class="pagina" ng-hide="!visivel"><div class="conteudo" ng-transclude="" ng-click="alternarDetalhe()"></div><div ng-click="alternarDetalhe()" class="detalhe" ng-class="{ocultar : !detalheVisivel}"><table class="detalhe-rodada"><tr><td class="cabecalho-detalhe-rodada" colspan="4">Detalhes da Rodada</td></tr><tr><td class="esquerda">Número:</td><td class="esquerda">{{conteudo.id}}</td><td class="esquerda">Total de Pontos:</td><td class="direita">{{conteudo.pontos}}</td></tr><tr><td class="esquerda">Data:</td><td class="esquerda">{{conteudo.data | date : \'dd/MM/yyyy\'}}</td><td class="esquerda">Total de Placares:</td><td class="direita">{{conteudo.Placares}}</td></tr></table></div></div>')}]);